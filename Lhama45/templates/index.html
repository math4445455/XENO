<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Lhama45</title>

<link rel="manifest" href="/static/manifest.json">
<meta name="theme-color" content="#343541">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
body {
    margin: 0;
    background: #343541;
    color: #ececf1;
    font-family: Arial, Helvetica, sans-serif;
    display: flex;
    flex-direction: column;
    height: 100vh;
}

header {
    background: #202123;
    padding: 15px;
    text-align: center;
}

#chat {
    flex: 1;
    padding: 20px;
    overflow-y: auto;
}

.msg {
    margin-bottom: 12px;
    padding: 12px;
    border-radius: 8px;
}

.user { background: #444654; }
.bot { background: #3e3f4b; }

footer {
    background: #202123;
    padding: 10px;
}

form {
    display: flex;
    gap: 8px;
}

input {
    flex: 1;
    padding: 12px;
}

button {
    padding: 12px;
}
</style>
</head>

<body>

<header>
    <img src="/static/logo.png" height="32"><br>
    Lhama45
</header>

<div id="chat"></div>

<footer>
<form onsubmit="enviar(event)">
    <input id="input" placeholder="Digite sua pergunta">
    <button>Enviar</button>
</form>
</footer>

<script>
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("/static/service-worker.js");
}

const chat = document.getElementById("chat");

async function enviar(e) {
    e.preventDefault();
    const input = document.getElementById("input");
    const texto = input.value.trim();
    if (!texto) return;

    add(texto, "user");
    input.value = "";

    const resp = await fetch("/perguntar", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ texto })
    });

    const data = await resp.json();
    add(data.resposta, "bot");
}

function add(texto, tipo) {
    const div = document.createElement("div");
    div.className = "msg " + tipo;
    div.textContent = texto;
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
}
</script>

</body>
</html>